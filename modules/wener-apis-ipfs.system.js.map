{"version":3,"file":"wener-apis-ipfs.system.js","sources":["../../../../.yarn/cache/immer-npm-6.0.9-1cab3ed201-e55b0d70c9.zip/node_modules/immer/dist/immer.esm.js","../../src/libs/ipfs/gateway/checker.ts","../../src/libs/ipfs/gateway/selector.ts","../../src/libs/ipfs/gateway/gateways.ts","../../src/modules/ipfs/components/GatewayChecker.tsx"],"sourcesContent":["function n(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;e<t;e++)r[e-1]=arguments[e];if(\"production\"!==process.env.NODE_ENV){var i=L[n],o=i?\"function\"==typeof i?i.apply(null,r):i:\"unknown error nr: \"+n;throw Error(\"[Immer] \"+o)}throw Error(\"[Immer] minified error nr: \"+n+(r.length?\" \"+r.join(\",\"):\"\")+\". Find the full error at: https://bit.ly/3cXEKWf\")}function t(n){return!!n&&!!n[G]}function r(n){return!!n&&(function(n){if(!n||\"object\"!=typeof n)return!1;var t=Object.getPrototypeOf(n);return!t||t===Object.prototype}(n)||Array.isArray(n)||!!n[B]||!!n.constructor[B]||c(n)||s(n))}function e(n){if(n&&n[G])return n[G].t}function i(n,t,r){void 0===r&&(r=!1),0===o(n)?(r?Object.keys:Q)(n).forEach((function(r){return t(r,n[r],n)})):n.forEach((function(r,e){return t(e,r,n)}))}function o(n){var t=n[G];return t?t.i>3?t.i-4:t.i:Array.isArray(n)?1:c(n)?2:s(n)?3:0}function u(n,t){return 2===o(n)?n.has(t):Object.prototype.hasOwnProperty.call(n,t)}function a(n,t){return 2===o(n)?n.get(t):n[t]}function f(n,t){return n===t?0!==n||1/n==1/t:n!=n&&t!=t}function c(n){return U&&n instanceof Map}function s(n){return W&&n instanceof Set}function v(n){return n.o||n.t}function p(t,r){if(void 0===r&&(r=!1),Array.isArray(t))return t.slice();var e=Object.create(Object.getPrototypeOf(t));return i(t,(function(i){if(i!==G){var o=Object.getOwnPropertyDescriptor(t,i),u=o.value;o.get&&(r||n(1),u=o.get.call(t)),o.enumerable?e[i]=u:Object.defineProperty(e,i,{value:u,writable:!0,configurable:!0})}})),e}function d(n,e){t(n)||h(n)||!r(n)||(o(n)>1&&(n.set=n.add=n.clear=n.delete=l),Object.freeze(n),e&&i(n,(function(n,t){return d(t,!0)}),!0))}function l(){n(2)}function h(n){return null==n||\"object\"!=typeof n||Object.isFrozen(n)}function y(t){var r=V[t];return r||n(\"production\"!==process.env.NODE_ENV?18:19,t),r}function b(n,t){V[n]=t}function m(){return\"production\"===process.env.NODE_ENV||K||n(0),K}function _(n,t){t&&(y(\"Patches\"),n.u=[],n.s=[],n.v=t)}function j(n){O(n),n.p.forEach(w),n.p=null}function O(n){n===K&&(K=n.l)}function g(n){return K={p:[],l:K,h:n,m:!0,_:0}}function w(n){var t=n[G];0===t.i||1===t.i?t.j():t.O=!0}function S(t,e){e._=e.p.length;var i=e.p[0],o=void 0!==t&&t!==i;return e.h.g||y(\"ES5\").S(e,t,o),o?(i[G].P&&(j(e),n(4)),r(t)&&(t=P(e,t),e.l||A(e,t)),e.u&&y(\"Patches\").M(i[G],t,e.u,e.s)):t=P(e,i,[]),j(e),e.u&&e.v(e.u,e.s),t!==q?t:void 0}function P(n,t,r){if(h(t))return t;var e=t[G];if(!e)return i(t,(function(i,o){return M(n,e,t,i,o,r)}),!0),t;if(e.A!==n)return t;if(!e.P)return A(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=p(e.k,!0):e.o;i(o,(function(t,i){return M(n,e,o,t,i,r)})),A(n,o,!1),r&&n.u&&y(\"Patches\").R(e,r,n.u,n.s)}return e.o}function M(e,i,c,s,v,p){if(\"production\"!==process.env.NODE_ENV&&v===c&&n(5),t(v)){var d=P(e,v,p&&i&&3!==i.i&&!u(i.D,s)?p.concat(s):void 0);if(h=s,y=d,2===(b=o(l=c))?l.set(h,y):3===b?(l.delete(h),l.add(y)):l[h]=y,!t(d))return;e.m=!1}var l,h,y,b;if((!i||!f(v,a(i.t,s)))&&r(v)){if(!e.h.N&&e._<1)return;P(e,v),i&&i.A.l||A(e,v)}}function A(n,t,r){void 0===r&&(r=!1),n.h.N&&n.m&&d(t,r)}function x(n,t){var r=n[G],e=Reflect.getOwnPropertyDescriptor(r?v(r):n,t);return e&&e.value}function z(n){if(!n.P){if(n.P=!0,0===n.i||1===n.i){var t=n.o=p(n.t);i(n.p,(function(n,r){t[n]=r})),n.p=void 0}n.l&&z(n.l)}}function I(n){n.o||(n.o=p(n.t))}function E(n,t,r){var e=c(t)?y(\"MapSet\").T(t,r):s(t)?y(\"MapSet\").F(t,r):n.g?function(n,t){var r=Array.isArray(n),e={i:r?1:0,A:t?t.A:m(),P:!1,I:!1,D:{},l:t,t:n,k:null,p:{},o:null,j:null,C:!1},i=e,o=Y;r&&(i=[e],o=Z);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(t,r):y(\"ES5\").J(t,r);return(r?r.A:m()).p.push(e),e}function k(n,t){n.g?z(t):y(\"ES5\").K(t)}function R(){function e(n,t){var r=n[G];if(r&&!r.$){r.$=!0;var e=n[t];return r.$=!1,e}return n[t]}function o(n){n.P||(n.P=!0,n.l&&o(n.l))}function a(n){n.o||(n.o=c(n.t))}function c(n){var t=n&&n[G];if(t){t.$=!0;var r=p(t.k,!0);return t.$=!1,r}return p(n)}function s(n){for(var t=n.length-1;t>=0;t--){var r=n[t][G];if(!r.P)switch(r.i){case 5:l(r)&&o(r);break;case 4:d(r)&&o(r)}}}function d(n){for(var t=n.t,r=n.k,e=Object.keys(r),i=e.length-1;i>=0;i--){var o=e[i],a=t[o];if(void 0===a&&!u(t,o))return!0;var c=r[o],s=c&&c[G];if(s?s.t!==a:!f(c,a))return!0}return e.length!==Object.keys(t).length}function l(n){var t=n.k;if(t.length!==n.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}function h(t){t.O&&n(3,JSON.stringify(v(t)))}var y={};b(\"ES5\",{J:function(n,t){var u=Array.isArray(n),s=c(n);i(s,(function(t){!function(n,t,i){var u=y[t];u?u.enumerable=i:y[t]=u={enumerable:i,get:function(){return function(n,t){h(n);var i=e(v(n),t);return n.$?i:i===e(n.t,t)&&r(i)?(a(n),n.o[t]=E(n.A.h,i,n)):i}(this[G],t)},set:function(n){!function(n,t,r){if(h(n),n.D[t]=!0,!n.P){if(f(r,e(v(n),t)))return;o(n),a(n)}n.o[t]=r}(this[G],t,n)}},Object.defineProperty(n,t,u)}(s,t,u||function(n,t){var r=Object.getOwnPropertyDescriptor(n,t);return!(!r||!r.enumerable)}(n,t))}));var p={i:u?5:4,A:t?t.A:m(),P:!1,$:!1,I:!1,D:{},l:t,t:n,k:s,o:null,O:!1,C:!1};return Object.defineProperty(s,G,{value:p,writable:!0}),s},K:o,S:function(n,r,e){n.p.forEach((function(n){n[G].$=!0})),e?t(r)&&r[G].A===n&&s(n.p):(n.u&&function n(t){if(t&&\"object\"==typeof t){var r=t[G];if(r){var e=r.t,a=r.k,f=r.D,c=r.i;if(4===c)i(a,(function(t){t!==G&&(void 0!==e[t]||u(e,t)?f[t]||n(a[t]):(f[t]=!0,o(r)))})),i(e,(function(n){void 0!==a[n]||u(a,n)||(f[n]=!1,o(r))}));else if(5===c){if(l(r)&&(o(r),f.length=!0),a.length<e.length)for(var s=a.length;s<e.length;s++)f[s]=!1;else for(var v=e.length;v<a.length;v++)f[v]=!0;for(var p=Math.min(a.length,e.length),d=0;d<p;d++)void 0===f[d]&&n(a[d])}}}}(n.p[0]),s(n.p))}})}function D(){function r(n){if(!n||\"object\"!=typeof n)return n;if(Array.isArray(n))return n.map(r);if(c(n))return new Map(Array.from(n.entries()).map((function(n){return[n[0],r(n[1])]})));if(s(n))return new Set(Array.from(n).map(r));var t=Object.create(Object.getPrototypeOf(n));for(var e in n)t[e]=r(n[e]);return t}function e(n){return t(n)?r(n):n}var f=\"add\";b(\"Patches\",{U:function(t,e){return e.forEach((function(e){for(var i=e.path,u=e.op,c=t,s=0;s<i.length-1;s++)\"object\"!=typeof(c=a(c,i[s]))&&n(15,i.join(\"/\"));var v=o(c),p=r(e.value),d=i[i.length-1];switch(u){case\"replace\":switch(v){case 2:return c.set(d,p);case 3:n(16);default:return c[d]=p}case f:switch(v){case 1:return c.splice(d,0,p);case 2:return c.set(d,p);case 3:return c.add(p);default:return c[d]=p}case\"remove\":switch(v){case 1:return c.splice(d,1);case 2:return c.delete(d);case 3:return c.delete(e.value);default:return delete c[d]}default:n(17,u)}})),t},R:function(n,t,r,o){switch(n.i){case 0:case 4:case 2:return function(n,t,r,o){var c=n.t,s=n.o;i(n.D,(function(n,i){var v=a(c,n),p=a(s,n),d=i?u(c,n)?\"replace\":f:\"remove\";if(v!==p||\"replace\"!==d){var l=t.concat(n);r.push(\"remove\"===d?{op:d,path:l}:{op:d,path:l,value:p}),o.push(d===f?{op:\"remove\",path:l}:\"remove\"===d?{op:f,path:l,value:e(v)}:{op:\"replace\",path:l,value:e(v)})}}))}(n,t,r,o);case 5:case 1:return function(n,t,r,i){var o=n.t,u=n.D,a=n.o;if(a.length<o.length){var c=[a,o];o=c[0],a=c[1];var s=[i,r];r=s[0],i=s[1]}for(var v=a.length-o.length,p=0;o[p]===a[p]&&p<o.length;)++p;for(var d=o.length;d>p&&o[d-1]===a[d+v-1];)--d;for(var l=p;l<d;++l)if(u[l]&&a[l]!==o[l]){var h=t.concat([l]);r.push({op:\"replace\",path:h,value:e(a[l])}),i.push({op:\"replace\",path:h,value:e(o[l])})}for(var y=r.length,b=d+v-1;b>=d;--b){var m=t.concat([b]);r[y+b-d]={op:f,path:m,value:e(a[b])},i.push({op:\"remove\",path:m})}}(n,t,r,o);case 3:return function(n,t,r,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=t.concat([u]);r.push({op:\"remove\",path:i,value:n}),e.unshift({op:f,path:i,value:n})}u++})),u=0,o.forEach((function(n){if(!i.has(n)){var o=t.concat([u]);r.push({op:f,path:o,value:n}),e.unshift({op:\"remove\",path:o,value:n})}u++}))}(n,t,r,o)}},M:function(n,t,r,e){r.push({op:\"replace\",path:[],value:t}),e.push({op:\"replace\",path:[],value:n.t})}})}function N(){function t(n,t){function r(){this.constructor=n}u(n,t),n.prototype=(r.prototype=t.prototype,new r)}function e(n){n.o||(n.D=new Map,n.o=new Map(n.t))}function i(n){n.o||(n.o=new Set,n.t.forEach((function(t){if(r(t)){var e=E(n.A.h,t,n);n.p.set(t,e),n.o.add(e)}else n.o.add(t)})))}function o(t){t.O&&n(3,JSON.stringify(v(t)))}var u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])})(n,t)},a=function(){function n(n,t){return this[G]={i:2,l:t,A:t?t.A:m(),P:!1,I:!1,o:void 0,D:void 0,t:n,k:this,C:!1,O:!1},this}t(n,Map);var i=n.prototype;return Object.defineProperty(i,\"size\",{get:function(){return v(this[G]).size}}),i.has=function(n){return v(this[G]).has(n)},i.set=function(n,t){var r=this[G];return o(r),v(r).get(n)!==t&&(e(r),k(r.A.h,r),r.D.set(n,!0),r.o.set(n,t),r.D.set(n,!0)),this},i.delete=function(n){if(!this.has(n))return!1;var t=this[G];return o(t),e(t),k(t.A.h,t),t.D.set(n,!1),t.o.delete(n),!0},i.clear=function(){var n=this[G];return o(n),e(n),k(n.A.h,n),n.D=new Map,n.o.clear()},i.forEach=function(n,t){var r=this;v(this[G]).forEach((function(e,i){n.call(t,r.get(i),i,r)}))},i.get=function(n){var t=this[G];o(t);var i=v(t).get(n);if(t.I||!r(i))return i;if(i!==t.t.get(n))return i;var u=E(t.A.h,i,t);return e(t),t.o.set(n,u),u},i.keys=function(){return v(this[G]).keys()},i.values=function(){var n,t=this,r=this.keys();return(n={})[H]=function(){return t.values()},n.next=function(){var n=r.next();return n.done?n:{done:!1,value:t.get(n.value)}},n},i.entries=function(){var n,t=this,r=this.keys();return(n={})[H]=function(){return t.entries()},n.next=function(){var n=r.next();if(n.done)return n;var e=t.get(n.value);return{done:!1,value:[n.value,e]}},n},i[H]=function(){return this.entries()},n}(),f=function(){function n(n,t){return this[G]={i:3,l:t,A:t?t.A:m(),P:!1,I:!1,o:void 0,t:n,k:this,p:new Map,O:!1,C:!1},this}t(n,Set);var r=n.prototype;return Object.defineProperty(r,\"size\",{get:function(){return v(this[G]).size}}),r.has=function(n){var t=this[G];return o(t),t.o?!!t.o.has(n)||!(!t.p.has(n)||!t.o.has(t.p.get(n))):t.t.has(n)},r.add=function(n){var t=this[G];return o(t),this.has(n)||(i(t),k(t.A.h,t),t.o.add(n)),this},r.delete=function(n){if(!this.has(n))return!1;var t=this[G];return o(t),i(t),k(t.A.h,t),t.o.delete(n)||!!t.p.has(n)&&t.o.delete(t.p.get(n))},r.clear=function(){var n=this[G];return o(n),i(n),k(n.A.h,n),n.o.clear()},r.values=function(){var n=this[G];return o(n),i(n),n.o.values()},r.entries=function(){var n=this[G];return o(n),i(n),n.o.entries()},r.keys=function(){return this.values()},r[H]=function(){return this.values()},r.forEach=function(n,t){for(var r=this.values(),e=r.next();!e.done;)n.call(t,e.value,e.value,this),e=r.next()},n}();b(\"MapSet\",{T:function(n,t){return new a(n,t)},F:function(n,t){return new f(n,t)}})}function T(){R(),N(),D()}function F(n){return n}function C(n){return n}var J,K,$=\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol(\"x\"),U=\"undefined\"!=typeof Map,W=\"undefined\"!=typeof Set,X=\"undefined\"!=typeof Proxy&&void 0!==Proxy.revocable&&\"undefined\"!=typeof Reflect,q=$?Symbol(\"immer-nothing\"):((J={})[\"immer-nothing\"]=!0,J),B=$?Symbol(\"immer-draftable\"):\"__$immer_draftable\",G=$?Symbol(\"immer-state\"):\"__$immer_state\",H=\"undefined\"!=typeof Symbol&&Symbol.iterator||\"@@iterator\",L={0:\"Illegal state\",1:\"Immer drafts cannot have computed properties\",2:\"This object has been frozen and should not be mutated\",3:function(n){return\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \"+n},4:\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",5:\"Immer forbids circular references\",6:\"The first or second argument to `produce` must be a function\",7:\"The third argument to `produce` must be a function or undefined\",8:\"First argument to `createDraft` must be a plain object, an array, or an immerable object\",9:\"First argument to `finishDraft` must be a draft returned by `createDraft`\",10:\"The given draft is already finalized\",11:\"Object.defineProperty() cannot be used on an Immer draft\",12:\"Object.setPrototypeOf() cannot be used on an Immer draft\",13:\"Immer only supports deleting array indices\",14:\"Immer only supports setting array indices and the 'length' property\",15:function(n){return\"Cannot apply patch, path doesn't resolve: \"+n},16:'Sets cannot have \"replace\" patches.',17:function(n){return\"Unsupported patch operation: \"+n},18:function(n){return\"The plugin for '\"+n+\"' has not been loaded into Immer. To enable the plugin, import and call `enable\"+n+\"()` when initializing your application.\"},19:function(n){return\"plugin not loaded: \"+n},20:\"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\"},Q=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,V={},Y={get:function(n,t){if(t===G)return n;var e=n.p;if(!n.P&&u(e,t))return e[t];var i=v(n)[t];if(n.I||!r(i))return i;if(n.P){if(i!==x(n.t,t))return i;e=n.o}return e[t]=E(n.A.h,i,n)},has:function(n,t){return t in v(n)},ownKeys:function(n){return Reflect.ownKeys(v(n))},set:function(n,t,r){if(!n.P){var e=x(n.t,t);if(r?f(e,r)||r===n.p[t]:f(e,r)&&t in n.t)return!0;I(n),z(n)}return n.D[t]=!0,n.o[t]=r,!0},deleteProperty:function(n,t){return void 0!==x(n.t,t)||t in n.t?(n.D[t]=!1,I(n),z(n)):n.D[t]&&delete n.D[t],n.o&&delete n.o[t],!0},getOwnPropertyDescriptor:function(n,t){var r=v(n),e=Reflect.getOwnPropertyDescriptor(r,t);return e&&(e.writable=!0,e.configurable=1!==n.i||\"length\"!==t),e},defineProperty:function(){n(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12)}},Z={};i(Y,(function(n,t){Z[n]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Z.deleteProperty=function(t,r){return\"production\"!==process.env.NODE_ENV&&isNaN(parseInt(r))&&n(13),Y.deleteProperty.call(this,t[0],r)},Z.set=function(t,r,e){return\"production\"!==process.env.NODE_ENV&&\"length\"!==r&&isNaN(parseInt(r))&&n(14),Y.set.call(this,t[0],r,e,t[0])};var nn=function(){function e(n){this.g=X,this.N=\"production\"!==process.env.NODE_ENV,\"boolean\"==typeof(null==n?void 0:n.useProxies)&&this.setUseProxies(n.useProxies),\"boolean\"==typeof(null==n?void 0:n.autoFreeze)&&this.setAutoFreeze(n.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var i=e.prototype;return i.produce=function(t,e,i){if(\"function\"==typeof t&&\"function\"!=typeof e){var o=e;e=t;var u=this;return function(n){var t=this;void 0===n&&(n=o);for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return u.produce(n,(function(n){var r;return(r=e).call.apply(r,[t,n].concat(i))}))}}var a;if(\"function\"!=typeof e&&n(6),void 0!==i&&\"function\"!=typeof i&&n(7),r(t)){var f=g(this),c=E(this,t,void 0),s=!0;try{a=e(c),s=!1}finally{s?j(f):O(f)}return\"undefined\"!=typeof Promise&&a instanceof Promise?a.then((function(n){return _(f,i),S(n,f)}),(function(n){throw j(f),n})):(_(f,i),S(a,f))}if((a=e(t))!==q)return void 0===a&&(a=t),this.N&&d(a,!0),a},i.produceWithPatches=function(n,t){var r,e,i=this;return\"function\"==typeof n?function(t){for(var r=arguments.length,e=Array(r>1?r-1:0),o=1;o<r;o++)e[o-1]=arguments[o];return i.produceWithPatches(t,(function(t){return n.apply(void 0,[t].concat(e))}))}:[this.produce(n,t,(function(n,t){r=n,e=t})),r,e]},i.createDraft=function(t){r(t)||n(8);var e=g(this),i=E(this,t,void 0);return i[G].C=!0,O(e),i},i.finishDraft=function(t,r){var e=t&&t[G];\"production\"!==process.env.NODE_ENV&&(e&&e.C||n(9),e.I&&n(10));var i=e.A;return _(i,r),S(void 0,i)},i.setAutoFreeze=function(n){this.N=n},i.setUseProxies=function(t){X||n(20),this.g=t},i.applyPatches=function(n,r){var e;for(e=r.length-1;e>=0;e--){var i=r[e];if(0===i.path.length&&\"replace\"===i.op){n=i.value;break}}var o=y(\"Patches\").U;return t(n)?o(n,r):this.produce(n,(function(n){return o(n,r.slice(e+1))}))},e}(),tn=new nn,rn=tn.produce,en=tn.produceWithPatches.bind(tn),on=tn.setAutoFreeze.bind(tn),un=tn.setUseProxies.bind(tn),an=tn.applyPatches.bind(tn),fn=tn.createDraft.bind(tn),cn=tn.finishDraft.bind(tn);export default rn;export{nn as Immer,an as applyPatches,F as castDraft,C as castImmutable,fn as createDraft,T as enableAllPlugins,R as enableES5,N as enableMapSet,D as enablePatches,cn as finishDraft,B as immerable,t as isDraft,r as isDraftable,q as nothing,e as original,rn as produce,en as produceWithPatches,on as setAutoFreeze,un as setUseProxies};\n//# sourceMappingURL=immer.esm.js.map\n","/**\n * https://github.com/ipfs/public-gateway-checker\n */\nimport produce from 'immer';\n\nexport const CheckTextHash = 'bafybeifx7yeb55armcsxwwitkymga5xf53dxiarykms3ygqic223w5sk3m';\nexport const CheckTextContent = 'Hello from IPFS Gateway Checker';\n\nexport const CheckScriptHash = 'bafybeietzsezxbgeeyrmwicylb5tpvf7yutrm3bxrfaoulaituhbi7q6yi';\n\nexport interface GatewayCheckNodeState {\n  id;\n  index?;\n\n  startTime;\n  endTime?;\n\n  gateway;\n  hostname;\n\n  status: CheckerState;\n  cors: CheckerState;\n  origin: CheckerState;\n\n  error?;\n\n  signal?: AbortSignal;\n}\n\nexport type CheckStatus = 'new' | 'running' | 'error' | 'success';\n\nexport interface CheckerState {\n  startTime?;\n  endTime?;\n\n  status: 'new' | 'running' | 'error' | 'success';\n\n  error?;\n  result?;\n}\n\nexport const GlobalResolver: Record<string, (...any) => void> = {};\n\nexport function fetchGatewayChecker(gateway, { hash = null, content = null, signal = null } = {}) {\n  if (!hash) {\n    hash = CheckTextHash;\n    content = CheckTextContent;\n  }\n\n  const gatewayAndHash = gateway.replace(':hash', hash);\n  const now = Date.now();\n  const testUrl = `${gatewayAndHash}?now=${now}#x-ipfs-companion-no-redirect`;\n\n  return fetch(testUrl, { signal })\n    .then((res) => {\n      if (res.status >= 400) {\n        throw new Error(`gateway ${gateway} request failed ${res.status}`);\n      }\n      return res;\n    })\n    .then((res) => res.text())\n    .then((text) => {\n      if (content) {\n        const matched = content === text.trim();\n        if (!matched) {\n          throw new Error(`gateway ${gateway} content not match: ${text.trim()}`);\n        }\n      }\n      return gateway;\n    });\n}\n\nfunction checkCors({ getState }) {\n  const { gateway, signal } = getState();\n  return fetchGatewayChecker(gateway, { signal });\n}\n\nasync function checkOrigin({ getState }) {\n  const cidInSubdomain = getState().gateway.startsWith('https://:hash.ipfs.');\n  if (cidInSubdomain) {\n    return true;\n  } else {\n    throw new Error('cid not in sub-domain - expect start with \"https://:hash.ipfs.\"');\n  }\n}\n\nexport function OnScriptloaded(src) {\n  try {\n    const url = new URL(src);\n    const index = url.searchParams.get('i');\n    const resolver = GlobalResolver[index];\n    if (resolver) {\n      resolver();\n    } else {\n      console.error(`no resolver found for ${index}`);\n    }\n  } catch (e) {\n    // this is a URL exception, we can do nothing, user is probably using Internet Explorer\n    console.error(`unexpected error: ${src}`, e);\n  }\n}\n\nasync function checkStatus({ getState }: { getState(): GatewayCheckNodeState }) {\n  const { id, signal, gateway } = getState();\n  const gatewayAndScriptHash = gateway.replace(':hash', CheckScriptHash);\n\n  // we set a unused number as a url parameter, to try to prevent content caching\n  // is it right ? ... do you know a better way ? ... does it always work ?\n  const now = Date.now();\n\n  // 3 important things here\n  //   1) we add #x-ipfs-companion-no-redirect to the final url (self explanatory)\n  //   2) we add ?filename=anyname.js as a parameter to let the gateway guess Content-Type header\n  //      to be sent in headers in order to prevent CORB\n  //   3) parameter 'i' is the one used to identify the gateway once the script executes\n  const src = `${gatewayAndScriptHash}?i=${id}&now=${now}&filename=anyname.js#x-ipfs-companion-no-redirect`;\n\n  // ‰∏çÊîØÊåÅ abort - Èô§Èùû ÂÖà fetch\n  if (signal) {\n    await fetch(src, { signal }).then((v) => v.text());\n  }\n\n  return new Promise((resolve, reject) => {\n    try {\n      const script = document.createElement('script');\n      script.src = src;\n      document.body.append(script);\n      script.onerror = (e) => {\n        // we check this because the gateway could be already checked by CORS before onerror executes\n        // and, even though it is failing here, we know it is UP\n        reject(e?.['error'] ?? e);\n      };\n      script.onload = (e) => {\n        setTimeout(() => reject('load script is invalid'), 500);\n      };\n\n      GlobalResolver[id] = (v) => {\n        delete GlobalResolver[id];\n        resolve(v);\n      };\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nasync function check(opts: {\n  checker;\n  name;\n  getState: () => GatewayCheckNodeState;\n  onStateChange: (update: (s: GatewayCheckNodeState) => void) => void;\n}) {\n  const { onStateChange, getState } = opts;\n  const { checker, name, ...passBy } = opts;\n\n  onStateChange((s) => {\n    const check = s[name];\n\n    check.startTime = Date.now();\n    check.status = 'running';\n  });\n\n  try {\n    const result = await checker(passBy);\n\n    onStateChange((s) => {\n      const check = s[name];\n      if (check.status === 'running') {\n        check.status = 'success';\n      }\n      check.result = result;\n      check.endTime = Date.now();\n    });\n  } catch (e) {\n    // const {gateway} = getState();\n    // console.error(`check failed ${gateway} - ${name}`, e);\n    onStateChange((s) => {\n      const check = s[name];\n      if (check.status === 'running') {\n        check.status = 'error';\n      }\n      check.error = e;\n      check.endTime = Date.now();\n    });\n  }\n}\n\nlet _uid = 0;\n\nexport function compareCheckState(a: GatewayCheckNodeState, b: GatewayCheckNodeState) {\n  if (a.status?.status === b.status?.status) {\n    if (a.status?.status === 'success') {\n      return a.status.endTime - a.status.startTime - (b.status.endTime - b.status.startTime);\n    }\n\n    return 0;\n  }\n  if (a.status?.status === 'success') {\n    return -1;\n  }\n  if (b.status?.status === 'success') {\n    return 1;\n  }\n  return 0;\n}\n\nexport async function checkGateways(\n  gateways: string[],\n  onStateChange: (s: GatewayCheckNodeState[]) => void,\n  { signal = null } = {},\n) {\n  let state = new Array(gateways.length);\n\n  await Promise.all(\n    gateways.map((v, i) =>\n      checkGateway(v, (s) => {\n        state = produce(state, (base) => {\n          base[i] = s;\n        });\n        onStateChange(state);\n      }),\n    ),\n  );\n  return state;\n}\n\nexport async function checkGateway(gateway, onStateChange: (s: GatewayCheckNodeState) => void, { signal = null } = {}) {\n  let state: GatewayCheckNodeState = {\n    id: _uid++,\n\n    gateway,\n    hostname: gatewayHostname(new URL(gateway.replace(':hash', CheckTextHash))),\n\n    startTime: Date.now(),\n\n    status: { status: 'new' },\n    cors: { status: 'new' },\n    origin: { status: 'new' },\n\n    signal,\n  };\n  onStateChange(state);\n\n  const opts = {\n    getState() {\n      return state;\n    },\n    onStateChange(update) {\n      const neo = produce(state, update);\n      if (neo === state) {\n        return;\n      }\n      state = neo;\n      onStateChange(state);\n    },\n  };\n\n  await Promise.all([\n    check({ ...opts, name: 'status', checker: checkStatus }),\n    check({ ...opts, name: 'cors', checker: checkCors }),\n    check({ ...opts, name: 'origin', checker: checkOrigin }),\n  ]);\n\n  opts.onStateChange((s) => {\n    s.endTime = Date.now();\n  });\n\n  return state;\n}\n\nfunction gatewayHostname(url) {\n  if (url && url.hostname) url = url.hostname.toString();\n  return url\n    .replace(`${CheckTextHash}.ipfs.`, '') // skip .ipfs. in subdomain gateways\n    .replace(`${CheckTextHash}.`, ''); // path-based\n}\n","import { fetchGatewayChecker } from './checker';\nimport { getGlobalThis } from '@wener/utils';\nimport { urljoin } from '@wener/utils';\nimport { isDev } from '@wener/utils';\n\nexport function detectingDummyFastestGateway(gateways: string[]): Promise<string> {\n  return firstSuccessResolve(gateways.map((gw) => fetchGatewayChecker(gw))) as any;\n}\n\nfunction firstSuccessResolve(promises) {\n  return new Promise((resolve, reject) => {\n    const errors = [];\n    Promise.all(promises.map((promise) => promise.then(resolve).catch((e) => errors.push(e)))).finally(() =>\n      reject(errors),\n    );\n  });\n}\n\nexport function buildIpfsUrl(gateway, hash, ...path) {\n  gateway = gateway || getPreferIpfsGateway();\n  return urljoin(gateway.replace(':hash', hash), ...path);\n}\n\nexport function setPreferIpfsGateway(gateway) {\n  if (getGlobalThis()?.localStorage) {\n    getGlobalThis().localStorage['IPFS_PREFER_GW'] = gateway;\n  } else {\n    getGlobalThis()['IPFS_PREFER_GW'] = gateway;\n  }\n}\n\nexport function getPreferIpfsGateway() {\n  // localStorage['IPFS_PREFER_GW'].replace(':hash','111')\n  let gw =\n    getGlobalThis()?.localStorage?.['IPFS_PREFER_GW'] ??\n    getGlobalThis()?.['IPFS_PREFER_GW'] ??\n    process.env.IPFS_PREFER_GW;\n  gw = gw || (isDev() ? 'http://127.0.0.1:8080/ipfs/:hash' : 'https://ipfs.io/ipfs/:hash');\n\n  return gw;\n}\n","export const PublicGateways = [\n  'https://ipfs.io/ipfs/:hash',\n  'https://:hash.ipfs.dweb.link',\n  'https://gateway.ipfs.io/ipfs/:hash',\n  'https://ipfs.infura.io/ipfs/:hash',\n  'https://rx14.co.uk/ipfs/:hash',\n  'https://ninetailed.ninja/ipfs/:hash',\n  'https://ipfs.globalupload.io/:hash',\n  'https://ipfs.jes.xxx/ipfs/:hash',\n  'https://10.via0.com/ipfs/:hash',\n  'https://ipfs.eternum.io/ipfs/:hash',\n  'https://hardbin.com/ipfs/:hash',\n  'https://ipfs.wa.hle.rs/ipfs/:hash',\n  'https://gateway.blocksec.com/ipfs/:hash',\n  'https://ipfs.renehsz.com/ipfs/:hash',\n  'https://cloudflare-ipfs.com/ipfs/:hash',\n  'https://:hash.ipfs.cf-ipfs.com',\n  'https://ipns.co/:hash',\n  'https://ipfs.mrh.io/ipfs/:hash',\n  'https://gateway.originprotocol.com/ipfs/:hash',\n  'https://gateway.pinata.cloud/ipfs/:hash',\n  'https://ipfs.doolta.com/ipfs/:hash',\n  'https://ipfs.sloppyta.co/ipfs/:hash',\n  'https://ipfs.busy.org/ipfs/:hash',\n  'https://ipfs.greyh.at/ipfs/:hash',\n  'https://gateway.serph.network/ipfs/:hash',\n  'https://jorropo.ovh/ipfs/:hash',\n  'https://gateway.temporal.cloud/ipfs/:hash',\n  'https://ipfs.fooock.com/ipfs/:hash',\n  'https://cdn.cwinfo.net/ipfs/:hash',\n  'https://ipfs.privacytools.io/ipfs/:hash',\n  'https://ipfs.jeroendeneef.com/ipfs/:hash',\n  'https://permaweb.io/ipfs/:hash',\n  'https://ipfs.stibarc.com/ipfs/:hash',\n  'https://ipfs.best-practice.se/ipfs/:hash',\n  'https://:hash.ipfs.2read.net',\n  'https://ipfs.2read.net/ipfs/:hash',\n  'https://storjipfs-gateway.com/ipfs/:hash',\n  'http://127.0.0.1:8080/ipfs/:hash',\n];\n","import React, { useEffect, useRef, useState } from 'react';\nimport { checkGateways, compareCheckState, OnScriptloaded } from 'src/libs/ipfs/gateway/checker';\nimport { getPreferIpfsGateway, setPreferIpfsGateway } from 'src/libs/ipfs/gateway/selector';\nimport { Button } from 'antd';\nimport { PublicGateways } from 'src/libs/ipfs/gateway/gateways';\n\nexport const GatewayChecker: React.FC<{ gateways: string[] }> = ({ gateways = PublicGateways }) => {\n  const abortRef = useRef<AbortController>();\n  const [checks, setChecks] = useState([]);\n  const [prefer, setPrefer] = useState(getPreferIpfsGateway);\n\n  useEffect(() => {\n    window['OnScriptloaded'] = OnScriptloaded;\n  }, []);\n\n  useEffect(() => {\n    abortRef.current?.abort();\n    let abort: AbortController = null;\n    try {\n      abort = new AbortController();\n    } catch (e) {\n      // ignore\n    }\n    abortRef.current = abort;\n\n    abort?.signal?.addEventListener('abort', () => {\n      console.log(`Abort checking`);\n    });\n\n    checkGateways(gateways, setChecks, { signal: abort?.signal }).then((v) => {\n      if (!abort?.signal?.aborted) {\n        setPrefer(v[0].gateway);\n      }\n    });\n\n    return () => {\n      abort?.abort();\n    };\n  }, [gateways]);\n\n  useEffect(() => {\n    if (prefer === getPreferIpfsGateway()) {\n      return;\n    }\n    setPreferIpfsGateway(prefer);\n  }, [prefer]);\n\n  return (\n    <div>\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        <div className=\"check-status\" style={{ backgroundColor: '#0b3a53' }}>\n          {checks.filter((v) => v.endTime).length}/{checks.length} ÊµãËØï\n        </div>\n        <div className=\"check-status\" style={{ backgroundColor: '#0cb892' }}>\n          {checks.filter((v) => v.status.status === 'success').length} Âú®Á∫ø\n        </div>\n        <div>{stateEmoji(checks.find((v) => !v.endTime) ? 'running' : 'success')}</div>\n        <div>ÂΩìÂâçÂÅèÂ•ΩÁΩëÂÖ≥ {prefer}</div>\n      </div>\n      <table className=\"check-table\">\n        <thead>\n          <tr>\n            <th>Online</th>\n            <th>CORS</th>\n            <th>Origin</th>\n            <th>Hostname / ‰∏ªÊú∫Âêç</th>\n            <th>ŒîT</th>\n          </tr>\n        </thead>\n        <tbody>\n          {Array.from(checks)\n            .sort(compareCheckState)\n            .map(({ gateway, hostname, status, cors, origin }) => (\n              <tr key={gateway}>\n                <td title={latency(cors)}>{stateEmoji(status.status)}</td>\n                <td title={latency(cors)}>{stateEmoji(cors.status)}</td>\n                <td>{stateEmoji(origin.status)}</td>\n                <td>\n                  <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                    <div>{hostname}</div>\n                    <div>\n                      <span>{gateway}</span>\n                      <span>\n                        <Button\n                          type=\"link\"\n                          size=\"small\"\n                          disabled={prefer === gateway}\n                          onClick={() => setPrefer(gateway)}\n                        >\n                          ‰ΩøÁî®\n                        </Button>\n                      </span>\n                    </div>\n                  </div>\n                </td>\n                <td>{latency(status)}</td>\n              </tr>\n            ))}\n        </tbody>\n      </table>\n\n      <style jsx>{`\n        .check-status {\n          width: 8em;\n          text-align: center;\n          margin: 0 0.8em;\n          user-select: none;\n          color: white;\n\n          font-family: monospace;\n          border-radius: 1em;\n          font-size: 1.2em;\n        }\n\n        .check-table {\n          font-family: monospace;\n          text-align: center;\n          width: 100%;\n        }\n        .check-table tr:hover {\n          background-color: #edf0f4;\n        }\n\n        .check-table th:nth-child(1),\n        .check-table th:nth-child(2),\n        .check-table th:nth-child(3) {\n          max-width: 30px;\n        }\n        .check-table td:nth-child(4),\n        .check-table th:nth-child(4) {\n          text-align: left;\n        }\n        .check-table td:nth-child(5),\n        .check-table th:nth-child(5) {\n          text-align: right;\n        }\n        .check-table th {\n          min-width: 50px;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nfunction latency({ startTime, endTime }) {\n  if (endTime) {\n    return ((endTime - startTime) / 1000).toFixed(2) + ' s';\n  }\n  return '';\n}\n\nfunction stateEmoji(s) {\n  switch (s) {\n    case 'new':\n      return 'üÜï';\n    case 'running':\n      return 'üïë';\n    case 'error':\n      return '‚ùå';\n    case 'success':\n      return '‚úÖ';\n    default:\n      return s;\n  }\n}\n"],"names":["die","error","args","e","errors","msg","apply","Error","length","join","data","path","op","plugin","CheckTextHash","CheckTextContent","CheckScriptHash","GlobalResolver","fetchGatewayChecker","gateway","hash","content","signal","gatewayAndHash","replace","now","Date","testUrl","fetch","then","res","status","text","matched","trim","checkCors","getState","checkOrigin","cidInSubdomain","startsWith","OnScriptloaded","src","url","URL","index","searchParams","get","resolver","console","checkStatus","id","gatewayAndScriptHash","v","Promise","resolve","reject","script","document","createElement","body","append","onerror","onload","setTimeout","check","opts","onStateChange","checker","name","passBy","s","startTime","result","endTime","_uid","compareCheckState","a","b","checkGateways","gateways","state","Array","all","map","i","checkGateway","produce","base","hostname","gatewayHostname","cors","origin","update","neo","toString","setPreferIpfsGateway","getGlobalThis","localStorage","getPreferIpfsGateway","gw","process","env","IPFS_PREFER_GW","isDev","PublicGateways","GatewayChecker","abortRef","useRef","checks","setChecks","useState","prefer","setPrefer","useEffect","window","current","abort","AbortController","addEventListener","log","aborted","display","alignItems","backgroundColor","filter","stateEmoji","find","from","sort","latency","justifyContent","toFixed"],"mappings":"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"}