{"version":3,"file":"wener-apis-mgmt.system.min.js","sources":["../../src/modules/mgmt/ModuleManagementService.ts","../../../../.yarn/cache/immer-npm-6.0.9-1cab3ed201-e55b0d70c9.zip/node_modules/immer/dist/immer.esm.js","../../../../.yarn/$$virtual/use-immer-virtual-125d4b5db4/0/cache/use-immer-npm-0.4.0-49af8e1014-ec02caa3b2.zip/node_modules/use-immer/dist/use-immer.module.js","../../src/modules/mgmt/components/ModuleList.tsx","../../src/modules/mgmt/components/ModuleManagementPanel.tsx"],"sourcesContent":["import { getBootService, loadImportOverrides, ModuleService, persistImportOverrides } from 'src/modules/boot';\nimport ModuleMetas from './modules.json';\n\nexport interface ModuleInfo {\n  name;\n  resolved?;\n  internal?: boolean;\n  predefined?: boolean;\n  override?: boolean;\n  loaded?;\n  metadata?;\n  hasMetadata?: boolean;\n\n  loading?;\n  version?;\n\n  source?: string;\n\n  dependencies?: string[];\n  dependents?: string[];\n\n  size?: number;\n}\n\nexport function getVersionFromResolvedUrl(url) {\n  const jsdelivr = 'https://cdn.jsdelivr.net/npm/';\n  if (url.startsWith(jsdelivr)) {\n    const m = url.substr(jsdelivr.length).match(/(^@[^/]+[/])?[^/@]+@([^/]+)/);\n    if (m) {\n      return m[2];\n    }\n  }\n\n  return 'latest';\n}\n\nexport function getSourceFromResolvedUrl(url) {\n  const jsdelivr = 'https://cdn.jsdelivr.net/npm/';\n  if (url.startsWith(jsdelivr)) {\n    return 'jsdelivr';\n  }\n  const unpkg = 'https://unpkg.com/';\n  if (url.startsWith(unpkg)) {\n    return 'unpkg';\n  }\n  if (url.startsWith(location.origin)) {\n    return 'site';\n  }\n  // ignore 172\n  if (/^https?:\\/\\/(localhost|127\\.0\\.0|192\\.168|10\\.)/.test(url)) {\n    return 'localhost';\n  }\n  return 'unknown';\n}\n\nexport class ModuleManagementService {\n  private _boot = getBootService();\n  private _modules: ModuleService = this._boot.modules;\n  private System = this._boot.System;\n\n  async addOverrideModule({ name, resolved }) {\n    this._modules.overrides[name] = resolved;\n    await this.persistImportOverrides();\n  }\n  async removeOverrideModule({ name }) {\n    delete this._modules.overrides[name];\n    await this.persistImportOverrides();\n  }\n  async resetOverrideModules() {\n    this._modules.overrides = {};\n    await this.persistImportOverrides();\n  }\n\n  async loadImportOverrides() {\n    Object.assign(this._modules.overrides, await loadImportOverrides());\n  }\n\n  async persistImportOverrides() {\n    return await persistImportOverrides(this._modules.overrides);\n  }\n\n  getModules(): ModuleInfo[] {\n    const { System, _modules } = this;\n\n    let all: ModuleInfo[] = [];\n    all = all.concat(\n      Object.entries(_modules.imports).map(([name, resolved]) => ({\n        name,\n        resolved,\n        predefined: true,\n      })),\n    );\n    {\n      // 使用预先有的元数据覆盖\n      const byName = keyBy(all, 'name');\n      for (const v of ModuleMetas) {\n        const m = (byName[v.name] = byName[v.name] || { name: v.name, resolved: _modules.tryResolve(v.name) });\n        Object.assign(m, v);\n      }\n      // 添加 override 信息\n      for (const [name, resolved] of Object.entries(_modules.overrides)) {\n        byName[name] = Object.assign(byName[name] || {}, { name, resolved, override: true });\n      }\n      all = Object.values(byName);\n    }\n\n    const byResolved = keyBy(all, 'resolved');\n\n    for (const [url, mod] of System.entries()) {\n      // maybe deleted\n      if (!mod) {\n        continue;\n      }\n      const info = (byResolved[url] = byResolved[url] || { name: _modules.resolveName(url) || url, resolved: url });\n      info.loaded = true;\n\n      // load metadata\n      if (_modules.isInternal(info.name)) {\n        info.metadata = mod.metadata || {};\n      }\n    }\n\n    all = Object.values(byResolved);\n    all.forEach((v) => {\n      v.internal = _modules.isInternal(v.name);\n      v.hasMetadata = Boolean(Object.keys(v.metadata || {}).length);\n      v.source = getSourceFromResolvedUrl(v.resolved);\n      v.version = getVersionFromResolvedUrl(v.resolved);\n      v.dependencies = Array.from(_modules.dependencies[v.name] || []);\n    });\n\n    const dependents = {};\n    all\n      .flatMap(({ name, dependencies }) => dependencies.map((v) => [v, name]))\n      .reduce((v, [a, b]) => {\n        (v[a] = v[a] || []).push(b);\n        return v;\n      }, dependents);\n    all.forEach((v) => {\n      v.dependents = dependents[v.name] || [];\n    });\n    return all;\n  }\n}\n\nfunction keyBy(o: any[], key) {\n  return Object.fromEntries(o.map((v) => [v[key], v]));\n}\n","function n(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;e<t;e++)r[e-1]=arguments[e];if(\"production\"!==process.env.NODE_ENV){var i=L[n],o=i?\"function\"==typeof i?i.apply(null,r):i:\"unknown error nr: \"+n;throw Error(\"[Immer] \"+o)}throw Error(\"[Immer] minified error nr: \"+n+(r.length?\" \"+r.join(\",\"):\"\")+\". Find the full error at: https://bit.ly/3cXEKWf\")}function t(n){return!!n&&!!n[G]}function r(n){return!!n&&(function(n){if(!n||\"object\"!=typeof n)return!1;var t=Object.getPrototypeOf(n);return!t||t===Object.prototype}(n)||Array.isArray(n)||!!n[B]||!!n.constructor[B]||c(n)||s(n))}function e(n){if(n&&n[G])return n[G].t}function i(n,t,r){void 0===r&&(r=!1),0===o(n)?(r?Object.keys:Q)(n).forEach((function(r){return t(r,n[r],n)})):n.forEach((function(r,e){return t(e,r,n)}))}function o(n){var t=n[G];return t?t.i>3?t.i-4:t.i:Array.isArray(n)?1:c(n)?2:s(n)?3:0}function u(n,t){return 2===o(n)?n.has(t):Object.prototype.hasOwnProperty.call(n,t)}function a(n,t){return 2===o(n)?n.get(t):n[t]}function f(n,t){return n===t?0!==n||1/n==1/t:n!=n&&t!=t}function c(n){return U&&n instanceof Map}function s(n){return W&&n instanceof Set}function v(n){return n.o||n.t}function p(t,r){if(void 0===r&&(r=!1),Array.isArray(t))return t.slice();var e=Object.create(Object.getPrototypeOf(t));return i(t,(function(i){if(i!==G){var o=Object.getOwnPropertyDescriptor(t,i),u=o.value;o.get&&(r||n(1),u=o.get.call(t)),o.enumerable?e[i]=u:Object.defineProperty(e,i,{value:u,writable:!0,configurable:!0})}})),e}function d(n,e){t(n)||h(n)||!r(n)||(o(n)>1&&(n.set=n.add=n.clear=n.delete=l),Object.freeze(n),e&&i(n,(function(n,t){return d(t,!0)}),!0))}function l(){n(2)}function h(n){return null==n||\"object\"!=typeof n||Object.isFrozen(n)}function y(t){var r=V[t];return r||n(\"production\"!==process.env.NODE_ENV?18:19,t),r}function b(n,t){V[n]=t}function m(){return\"production\"===process.env.NODE_ENV||K||n(0),K}function _(n,t){t&&(y(\"Patches\"),n.u=[],n.s=[],n.v=t)}function j(n){O(n),n.p.forEach(w),n.p=null}function O(n){n===K&&(K=n.l)}function g(n){return K={p:[],l:K,h:n,m:!0,_:0}}function w(n){var t=n[G];0===t.i||1===t.i?t.j():t.O=!0}function S(t,e){e._=e.p.length;var i=e.p[0],o=void 0!==t&&t!==i;return e.h.g||y(\"ES5\").S(e,t,o),o?(i[G].P&&(j(e),n(4)),r(t)&&(t=P(e,t),e.l||A(e,t)),e.u&&y(\"Patches\").M(i[G],t,e.u,e.s)):t=P(e,i,[]),j(e),e.u&&e.v(e.u,e.s),t!==q?t:void 0}function P(n,t,r){if(h(t))return t;var e=t[G];if(!e)return i(t,(function(i,o){return M(n,e,t,i,o,r)}),!0),t;if(e.A!==n)return t;if(!e.P)return A(n,e.t,!0),e.t;if(!e.I){e.I=!0,e.A._--;var o=4===e.i||5===e.i?e.o=p(e.k,!0):e.o;i(o,(function(t,i){return M(n,e,o,t,i,r)})),A(n,o,!1),r&&n.u&&y(\"Patches\").R(e,r,n.u,n.s)}return e.o}function M(e,i,c,s,v,p){if(\"production\"!==process.env.NODE_ENV&&v===c&&n(5),t(v)){var d=P(e,v,p&&i&&3!==i.i&&!u(i.D,s)?p.concat(s):void 0);if(h=s,y=d,2===(b=o(l=c))?l.set(h,y):3===b?(l.delete(h),l.add(y)):l[h]=y,!t(d))return;e.m=!1}var l,h,y,b;if((!i||!f(v,a(i.t,s)))&&r(v)){if(!e.h.N&&e._<1)return;P(e,v),i&&i.A.l||A(e,v)}}function A(n,t,r){void 0===r&&(r=!1),n.h.N&&n.m&&d(t,r)}function x(n,t){var r=n[G],e=Reflect.getOwnPropertyDescriptor(r?v(r):n,t);return e&&e.value}function z(n){if(!n.P){if(n.P=!0,0===n.i||1===n.i){var t=n.o=p(n.t);i(n.p,(function(n,r){t[n]=r})),n.p=void 0}n.l&&z(n.l)}}function I(n){n.o||(n.o=p(n.t))}function E(n,t,r){var e=c(t)?y(\"MapSet\").T(t,r):s(t)?y(\"MapSet\").F(t,r):n.g?function(n,t){var r=Array.isArray(n),e={i:r?1:0,A:t?t.A:m(),P:!1,I:!1,D:{},l:t,t:n,k:null,p:{},o:null,j:null,C:!1},i=e,o=Y;r&&(i=[e],o=Z);var u=Proxy.revocable(i,o),a=u.revoke,f=u.proxy;return e.k=f,e.j=a,f}(t,r):y(\"ES5\").J(t,r);return(r?r.A:m()).p.push(e),e}function k(n,t){n.g?z(t):y(\"ES5\").K(t)}function R(){function e(n,t){var r=n[G];if(r&&!r.$){r.$=!0;var e=n[t];return r.$=!1,e}return n[t]}function o(n){n.P||(n.P=!0,n.l&&o(n.l))}function a(n){n.o||(n.o=c(n.t))}function c(n){var t=n&&n[G];if(t){t.$=!0;var r=p(t.k,!0);return t.$=!1,r}return p(n)}function s(n){for(var t=n.length-1;t>=0;t--){var r=n[t][G];if(!r.P)switch(r.i){case 5:l(r)&&o(r);break;case 4:d(r)&&o(r)}}}function d(n){for(var t=n.t,r=n.k,e=Object.keys(r),i=e.length-1;i>=0;i--){var o=e[i],a=t[o];if(void 0===a&&!u(t,o))return!0;var c=r[o],s=c&&c[G];if(s?s.t!==a:!f(c,a))return!0}return e.length!==Object.keys(t).length}function l(n){var t=n.k;if(t.length!==n.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}function h(t){t.O&&n(3,JSON.stringify(v(t)))}var y={};b(\"ES5\",{J:function(n,t){var u=Array.isArray(n),s=c(n);i(s,(function(t){!function(n,t,i){var u=y[t];u?u.enumerable=i:y[t]=u={enumerable:i,get:function(){return function(n,t){h(n);var i=e(v(n),t);return n.$?i:i===e(n.t,t)&&r(i)?(a(n),n.o[t]=E(n.A.h,i,n)):i}(this[G],t)},set:function(n){!function(n,t,r){if(h(n),n.D[t]=!0,!n.P){if(f(r,e(v(n),t)))return;o(n),a(n)}n.o[t]=r}(this[G],t,n)}},Object.defineProperty(n,t,u)}(s,t,u||function(n,t){var r=Object.getOwnPropertyDescriptor(n,t);return!(!r||!r.enumerable)}(n,t))}));var p={i:u?5:4,A:t?t.A:m(),P:!1,$:!1,I:!1,D:{},l:t,t:n,k:s,o:null,O:!1,C:!1};return Object.defineProperty(s,G,{value:p,writable:!0}),s},K:o,S:function(n,r,e){n.p.forEach((function(n){n[G].$=!0})),e?t(r)&&r[G].A===n&&s(n.p):(n.u&&function n(t){if(t&&\"object\"==typeof t){var r=t[G];if(r){var e=r.t,a=r.k,f=r.D,c=r.i;if(4===c)i(a,(function(t){t!==G&&(void 0!==e[t]||u(e,t)?f[t]||n(a[t]):(f[t]=!0,o(r)))})),i(e,(function(n){void 0!==a[n]||u(a,n)||(f[n]=!1,o(r))}));else if(5===c){if(l(r)&&(o(r),f.length=!0),a.length<e.length)for(var s=a.length;s<e.length;s++)f[s]=!1;else for(var v=e.length;v<a.length;v++)f[v]=!0;for(var p=Math.min(a.length,e.length),d=0;d<p;d++)void 0===f[d]&&n(a[d])}}}}(n.p[0]),s(n.p))}})}function D(){function r(n){if(!n||\"object\"!=typeof n)return n;if(Array.isArray(n))return n.map(r);if(c(n))return new Map(Array.from(n.entries()).map((function(n){return[n[0],r(n[1])]})));if(s(n))return new Set(Array.from(n).map(r));var t=Object.create(Object.getPrototypeOf(n));for(var e in n)t[e]=r(n[e]);return t}function e(n){return t(n)?r(n):n}var f=\"add\";b(\"Patches\",{U:function(t,e){return e.forEach((function(e){for(var i=e.path,u=e.op,c=t,s=0;s<i.length-1;s++)\"object\"!=typeof(c=a(c,i[s]))&&n(15,i.join(\"/\"));var v=o(c),p=r(e.value),d=i[i.length-1];switch(u){case\"replace\":switch(v){case 2:return c.set(d,p);case 3:n(16);default:return c[d]=p}case f:switch(v){case 1:return c.splice(d,0,p);case 2:return c.set(d,p);case 3:return c.add(p);default:return c[d]=p}case\"remove\":switch(v){case 1:return c.splice(d,1);case 2:return c.delete(d);case 3:return c.delete(e.value);default:return delete c[d]}default:n(17,u)}})),t},R:function(n,t,r,o){switch(n.i){case 0:case 4:case 2:return function(n,t,r,o){var c=n.t,s=n.o;i(n.D,(function(n,i){var v=a(c,n),p=a(s,n),d=i?u(c,n)?\"replace\":f:\"remove\";if(v!==p||\"replace\"!==d){var l=t.concat(n);r.push(\"remove\"===d?{op:d,path:l}:{op:d,path:l,value:p}),o.push(d===f?{op:\"remove\",path:l}:\"remove\"===d?{op:f,path:l,value:e(v)}:{op:\"replace\",path:l,value:e(v)})}}))}(n,t,r,o);case 5:case 1:return function(n,t,r,i){var o=n.t,u=n.D,a=n.o;if(a.length<o.length){var c=[a,o];o=c[0],a=c[1];var s=[i,r];r=s[0],i=s[1]}for(var v=a.length-o.length,p=0;o[p]===a[p]&&p<o.length;)++p;for(var d=o.length;d>p&&o[d-1]===a[d+v-1];)--d;for(var l=p;l<d;++l)if(u[l]&&a[l]!==o[l]){var h=t.concat([l]);r.push({op:\"replace\",path:h,value:e(a[l])}),i.push({op:\"replace\",path:h,value:e(o[l])})}for(var y=r.length,b=d+v-1;b>=d;--b){var m=t.concat([b]);r[y+b-d]={op:f,path:m,value:e(a[b])},i.push({op:\"remove\",path:m})}}(n,t,r,o);case 3:return function(n,t,r,e){var i=n.t,o=n.o,u=0;i.forEach((function(n){if(!o.has(n)){var i=t.concat([u]);r.push({op:\"remove\",path:i,value:n}),e.unshift({op:f,path:i,value:n})}u++})),u=0,o.forEach((function(n){if(!i.has(n)){var o=t.concat([u]);r.push({op:f,path:o,value:n}),e.unshift({op:\"remove\",path:o,value:n})}u++}))}(n,t,r,o)}},M:function(n,t,r,e){r.push({op:\"replace\",path:[],value:t}),e.push({op:\"replace\",path:[],value:n.t})}})}function N(){function t(n,t){function r(){this.constructor=n}u(n,t),n.prototype=(r.prototype=t.prototype,new r)}function e(n){n.o||(n.D=new Map,n.o=new Map(n.t))}function i(n){n.o||(n.o=new Set,n.t.forEach((function(t){if(r(t)){var e=E(n.A.h,t,n);n.p.set(t,e),n.o.add(e)}else n.o.add(t)})))}function o(t){t.O&&n(3,JSON.stringify(v(t)))}var u=function(n,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])})(n,t)},a=function(){function n(n,t){return this[G]={i:2,l:t,A:t?t.A:m(),P:!1,I:!1,o:void 0,D:void 0,t:n,k:this,C:!1,O:!1},this}t(n,Map);var i=n.prototype;return Object.defineProperty(i,\"size\",{get:function(){return v(this[G]).size}}),i.has=function(n){return v(this[G]).has(n)},i.set=function(n,t){var r=this[G];return o(r),v(r).get(n)!==t&&(e(r),k(r.A.h,r),r.D.set(n,!0),r.o.set(n,t),r.D.set(n,!0)),this},i.delete=function(n){if(!this.has(n))return!1;var t=this[G];return o(t),e(t),k(t.A.h,t),t.D.set(n,!1),t.o.delete(n),!0},i.clear=function(){var n=this[G];return o(n),e(n),k(n.A.h,n),n.D=new Map,n.o.clear()},i.forEach=function(n,t){var r=this;v(this[G]).forEach((function(e,i){n.call(t,r.get(i),i,r)}))},i.get=function(n){var t=this[G];o(t);var i=v(t).get(n);if(t.I||!r(i))return i;if(i!==t.t.get(n))return i;var u=E(t.A.h,i,t);return e(t),t.o.set(n,u),u},i.keys=function(){return v(this[G]).keys()},i.values=function(){var n,t=this,r=this.keys();return(n={})[H]=function(){return t.values()},n.next=function(){var n=r.next();return n.done?n:{done:!1,value:t.get(n.value)}},n},i.entries=function(){var n,t=this,r=this.keys();return(n={})[H]=function(){return t.entries()},n.next=function(){var n=r.next();if(n.done)return n;var e=t.get(n.value);return{done:!1,value:[n.value,e]}},n},i[H]=function(){return this.entries()},n}(),f=function(){function n(n,t){return this[G]={i:3,l:t,A:t?t.A:m(),P:!1,I:!1,o:void 0,t:n,k:this,p:new Map,O:!1,C:!1},this}t(n,Set);var r=n.prototype;return Object.defineProperty(r,\"size\",{get:function(){return v(this[G]).size}}),r.has=function(n){var t=this[G];return o(t),t.o?!!t.o.has(n)||!(!t.p.has(n)||!t.o.has(t.p.get(n))):t.t.has(n)},r.add=function(n){var t=this[G];return o(t),this.has(n)||(i(t),k(t.A.h,t),t.o.add(n)),this},r.delete=function(n){if(!this.has(n))return!1;var t=this[G];return o(t),i(t),k(t.A.h,t),t.o.delete(n)||!!t.p.has(n)&&t.o.delete(t.p.get(n))},r.clear=function(){var n=this[G];return o(n),i(n),k(n.A.h,n),n.o.clear()},r.values=function(){var n=this[G];return o(n),i(n),n.o.values()},r.entries=function(){var n=this[G];return o(n),i(n),n.o.entries()},r.keys=function(){return this.values()},r[H]=function(){return this.values()},r.forEach=function(n,t){for(var r=this.values(),e=r.next();!e.done;)n.call(t,e.value,e.value,this),e=r.next()},n}();b(\"MapSet\",{T:function(n,t){return new a(n,t)},F:function(n,t){return new f(n,t)}})}function T(){R(),N(),D()}function F(n){return n}function C(n){return n}var J,K,$=\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol(\"x\"),U=\"undefined\"!=typeof Map,W=\"undefined\"!=typeof Set,X=\"undefined\"!=typeof Proxy&&void 0!==Proxy.revocable&&\"undefined\"!=typeof Reflect,q=$?Symbol(\"immer-nothing\"):((J={})[\"immer-nothing\"]=!0,J),B=$?Symbol(\"immer-draftable\"):\"__$immer_draftable\",G=$?Symbol(\"immer-state\"):\"__$immer_state\",H=\"undefined\"!=typeof Symbol&&Symbol.iterator||\"@@iterator\",L={0:\"Illegal state\",1:\"Immer drafts cannot have computed properties\",2:\"This object has been frozen and should not be mutated\",3:function(n){return\"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \"+n},4:\"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",5:\"Immer forbids circular references\",6:\"The first or second argument to `produce` must be a function\",7:\"The third argument to `produce` must be a function or undefined\",8:\"First argument to `createDraft` must be a plain object, an array, or an immerable object\",9:\"First argument to `finishDraft` must be a draft returned by `createDraft`\",10:\"The given draft is already finalized\",11:\"Object.defineProperty() cannot be used on an Immer draft\",12:\"Object.setPrototypeOf() cannot be used on an Immer draft\",13:\"Immer only supports deleting array indices\",14:\"Immer only supports setting array indices and the 'length' property\",15:function(n){return\"Cannot apply patch, path doesn't resolve: \"+n},16:'Sets cannot have \"replace\" patches.',17:function(n){return\"Unsupported patch operation: \"+n},18:function(n){return\"The plugin for '\"+n+\"' has not been loaded into Immer. To enable the plugin, import and call `enable\"+n+\"()` when initializing your application.\"},19:function(n){return\"plugin not loaded: \"+n},20:\"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available\"},Q=\"undefined\"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,V={},Y={get:function(n,t){if(t===G)return n;var e=n.p;if(!n.P&&u(e,t))return e[t];var i=v(n)[t];if(n.I||!r(i))return i;if(n.P){if(i!==x(n.t,t))return i;e=n.o}return e[t]=E(n.A.h,i,n)},has:function(n,t){return t in v(n)},ownKeys:function(n){return Reflect.ownKeys(v(n))},set:function(n,t,r){if(!n.P){var e=x(n.t,t);if(r?f(e,r)||r===n.p[t]:f(e,r)&&t in n.t)return!0;I(n),z(n)}return n.D[t]=!0,n.o[t]=r,!0},deleteProperty:function(n,t){return void 0!==x(n.t,t)||t in n.t?(n.D[t]=!1,I(n),z(n)):n.D[t]&&delete n.D[t],n.o&&delete n.o[t],!0},getOwnPropertyDescriptor:function(n,t){var r=v(n),e=Reflect.getOwnPropertyDescriptor(r,t);return e&&(e.writable=!0,e.configurable=1!==n.i||\"length\"!==t),e},defineProperty:function(){n(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){n(12)}},Z={};i(Y,(function(n,t){Z[n]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Z.deleteProperty=function(t,r){return\"production\"!==process.env.NODE_ENV&&isNaN(parseInt(r))&&n(13),Y.deleteProperty.call(this,t[0],r)},Z.set=function(t,r,e){return\"production\"!==process.env.NODE_ENV&&\"length\"!==r&&isNaN(parseInt(r))&&n(14),Y.set.call(this,t[0],r,e,t[0])};var nn=function(){function e(n){this.g=X,this.N=\"production\"!==process.env.NODE_ENV,\"boolean\"==typeof(null==n?void 0:n.useProxies)&&this.setUseProxies(n.useProxies),\"boolean\"==typeof(null==n?void 0:n.autoFreeze)&&this.setAutoFreeze(n.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var i=e.prototype;return i.produce=function(t,e,i){if(\"function\"==typeof t&&\"function\"!=typeof e){var o=e;e=t;var u=this;return function(n){var t=this;void 0===n&&(n=o);for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return u.produce(n,(function(n){var r;return(r=e).call.apply(r,[t,n].concat(i))}))}}var a;if(\"function\"!=typeof e&&n(6),void 0!==i&&\"function\"!=typeof i&&n(7),r(t)){var f=g(this),c=E(this,t,void 0),s=!0;try{a=e(c),s=!1}finally{s?j(f):O(f)}return\"undefined\"!=typeof Promise&&a instanceof Promise?a.then((function(n){return _(f,i),S(n,f)}),(function(n){throw j(f),n})):(_(f,i),S(a,f))}if((a=e(t))!==q)return void 0===a&&(a=t),this.N&&d(a,!0),a},i.produceWithPatches=function(n,t){var r,e,i=this;return\"function\"==typeof n?function(t){for(var r=arguments.length,e=Array(r>1?r-1:0),o=1;o<r;o++)e[o-1]=arguments[o];return i.produceWithPatches(t,(function(t){return n.apply(void 0,[t].concat(e))}))}:[this.produce(n,t,(function(n,t){r=n,e=t})),r,e]},i.createDraft=function(t){r(t)||n(8);var e=g(this),i=E(this,t,void 0);return i[G].C=!0,O(e),i},i.finishDraft=function(t,r){var e=t&&t[G];\"production\"!==process.env.NODE_ENV&&(e&&e.C||n(9),e.I&&n(10));var i=e.A;return _(i,r),S(void 0,i)},i.setAutoFreeze=function(n){this.N=n},i.setUseProxies=function(t){X||n(20),this.g=t},i.applyPatches=function(n,r){var e;for(e=r.length-1;e>=0;e--){var i=r[e];if(0===i.path.length&&\"replace\"===i.op){n=i.value;break}}var o=y(\"Patches\").U;return t(n)?o(n,r):this.produce(n,(function(n){return o(n,r.slice(e+1))}))},e}(),tn=new nn,rn=tn.produce,en=tn.produceWithPatches.bind(tn),on=tn.setAutoFreeze.bind(tn),un=tn.setUseProxies.bind(tn),an=tn.applyPatches.bind(tn),fn=tn.createDraft.bind(tn),cn=tn.finishDraft.bind(tn);export default rn;export{nn as Immer,an as applyPatches,F as castDraft,C as castImmutable,fn as createDraft,T as enableAllPlugins,R as enableES5,N as enableMapSet,D as enablePatches,cn as finishDraft,B as immerable,t as isDraft,r as isDraftable,q as nothing,e as original,rn as produce,en as produceWithPatches,on as setAutoFreeze,un as setUseProxies};\n//# sourceMappingURL=immer.esm.js.map\n","import r from\"immer\";import{useState as n,useReducer as t,useCallback as o,useMemo as i}from\"react\";function u(t){var i=n(t),u=i[1];return[i[0],o(function(n){u(r(n))},[])]}function e(n,o,u){var e=i(function(){return r(n)},[n]);return t(e,o,u)}export{u as useImmer,e as useImmerReducer};\n//# sourceMappingURL=use-immer.module.js.map\n","import React from 'react';\nimport { List, Skeleton, Tag } from 'antd';\nimport { ModuleInfo } from 'src/modules/mgmt/ModuleManagementService';\n\nexport const ModuleList: React.FC<{\n  loading?;\n  renderActions?;\n  modules: ModuleInfo[];\n  onModuleLoad?;\n  onModuleUnload?;\n}> = ({ loading, modules, renderActions = (v) => [] }) => {\n  return (\n    <div>\n      <List\n        loading={loading}\n        itemLayout=\"horizontal\"\n        dataSource={modules}\n        renderItem={(item) => (\n          <List.Item actions={[...renderActions(item)]}>\n            <Skeleton avatar title={false} loading={item.loading} active>\n              <List.Item.Meta\n                title={\n                  <div>\n                    <span>{item.name + (item.metadata?.title ? ` / ${item.metadata?.title}` : '')}</span>\n                    <span style={{ paddingLeft: 10 }}>\n                      {item.loaded && <Tag color=\"magenta\">已加载</Tag>}\n                      {item.predefined && <Tag color=\"green\">预定义</Tag>}\n                      {item.internal && <Tag color=\"lime\">内部模块</Tag>}\n                      {item.hasMetadata && <Tag color=\"gold\">含元数据</Tag>}\n                      {item.override && <Tag color=\"geekblue\">覆盖</Tag>}\n                    </span>\n                  </div>\n                }\n                description={item.metadata?.description}\n              />\n              <div>\n                <div>\n                  <small>{item.resolved}</small>\n                  <span style={{ paddingLeft: 8 }}>\n                    <Tag>{item.version}</Tag>\n                    <Tag>{item.source}</Tag>\n                  </span>\n                </div>\n                <div style={{ maxWidth: '30vw' }}>\n                  {Boolean(item.dependencies.length) && (\n                    <div>\n                      <small>依赖: {item.dependencies.join(',')}</small>\n                    </div>\n                  )}\n                  {Boolean(item.dependents.length) && (\n                    <div>\n                      <small>被依赖: {item.dependents.join(',')}</small>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </Skeleton>\n          </List.Item>\n        )}\n      />\n    </div>\n  );\n};\n","import React, { useEffect, useRef } from 'react';\nimport { Button, Dropdown, Form, Input, Menu, message, Modal, notification } from 'antd';\nimport { ModuleInfo, ModuleManagementService } from 'src/modules/mgmt/ModuleManagementService';\nimport { useImmer } from 'use-immer';\nimport { getBootService } from 'src/modules/boot';\nimport { ClearOutlined, PlusSquareOutlined, ReloadOutlined } from '@ant-design/icons';\nimport { ModuleList } from 'src/modules/mgmt/components/ModuleList';\nimport { DownOutlined, EditOutlined, MinusSquareOutlined, UploadOutlined } from '@ant-design/icons/lib';\n\nlet _svc;\n\nfunction getModuleMgmtService(): ModuleManagementService {\n  return (_svc = _svc || new ModuleManagementService());\n}\n\nexport const ModuleManagementPanel: React.FC = () => {\n  const svc = getModuleMgmtService();\n  const System = getBootService().System;\n\n  const [modules, updateModules] = useImmer<ModuleInfo[]>(() =>\n    svc.getModules().sort((a, b) => a.name.localeCompare(b.name)),\n  );\n  const doRefresh = () => {\n    updateModules((s) => svc.getModules().sort((a, b) => a.name.localeCompare(b.name)));\n  };\n  const doAddLocalModule = async (module) => {\n    await svc.addOverrideModule(module);\n    doRefresh();\n  };\n  const doResetLocalModule = async () => {\n    await svc.resetOverrideModules();\n    doRefresh();\n  };\n\n  const doModuleLoad = async (name) => {\n    updateModules((modules) => {\n      modules.find((v) => v.name === name).loading = true;\n    });\n    try {\n      await System.import(name);\n      updateModules((modules) => {\n        const m = modules.find((v) => v.name === name);\n        m.loading = false;\n        m.loaded = true;\n        //\n        m.dependencies = Array.from(getBootService().modules.dependencies[name] || []);\n\n        for (const depName of m.dependencies) {\n          const dep = modules.find((v) => v.name === depName);\n          if (dep && !dep.dependents.includes(name)) {\n            dep.dependents = [...dep.dependents, name];\n          }\n        }\n      });\n    } catch (e) {\n      notification.error({ message: String(e) });\n\n      updateModules((modules) => {\n        const m = modules.find((v) => v.name === name);\n        m.loading = false;\n        m.loaded = false;\n      });\n    }\n  };\n\n  const doModuleUnload = (name) => {\n    updateModules((modules) => {\n      const m = modules.find((v) => v.name === name);\n      System.delete(m.resolved);\n\n      m.loading = false;\n      m.loaded = System.has(m.resolved);\n    });\n  };\n  const [edit, updateEdit] = useImmer({ editing: false, module: undefined });\n  const onModuleEdit = (module) => {\n    updateEdit((s) => {\n      s.editing = true;\n      s.module = module;\n    });\n  };\n  const onModulePublish = (module) => {\n    message.warn('尚未实现');\n  };\n  const onModuleReset = async (module) => {\n    await svc.removeOverrideModule(module);\n    doRefresh();\n  };\n  return (\n    <div>\n      <ModuleEditDialog\n        visible={edit.editing}\n        module={edit.module}\n        onModuleChange={async (v) => doAddLocalModule(v)}\n        onVisibleChange={(v) =>\n          updateEdit((s) => {\n            s.editing = v;\n          })\n        }\n      />\n      <div>\n        <ModuleToolBar\n          onRefresh={doRefresh}\n          onResetLocalModule={doResetLocalModule}\n          onAddLocalModule={doAddLocalModule}\n        />\n      </div>\n      <ModuleList\n        modules={modules}\n        onModuleLoad={doModuleLoad}\n        onModuleUnload={doModuleUnload}\n        renderActions={renderModuleActions({\n          onModuleUnload: doModuleUnload,\n          onModuleLoad: doModuleLoad,\n          onModuleReset,\n          onModuleEdit,\n          onModulePublish,\n        })}\n      />\n    </div>\n  );\n};\n\nfunction renderModuleActions(opts: {\n  onModuleLoad?;\n  onModuleUnload?;\n  onModulePublish?;\n  onModuleEdit?;\n  onModuleReset?;\n}) {\n  const { onModuleLoad, onModuleUnload, onModuleEdit, onModulePublish, onModuleReset } = opts;\n  return (item: ModuleInfo) => [\n    <Button onClick={() => onModuleLoad(item.name)} type=\"link\" key=\"load\" size=\"small\" disabled={item.loaded}>\n      加载\n    </Button>,\n    <Button onClick={() => onModuleUnload(item.name)} type=\"link\" key=\"unload\" size=\"small\" disabled={!item.loaded}>\n      卸载\n    </Button>,\n    <Dropdown\n      key={'more'}\n      overlay={\n        <Menu>\n          <Menu.Item onClick={() => onModulePublish(item)} icon={<UploadOutlined />}>\n            发布\n          </Menu.Item>\n          <Menu.Item onClick={() => onModuleEdit(item)} icon={<EditOutlined />}>\n            编辑\n          </Menu.Item>\n          <Menu.Item onClick={() => onModuleReset(item)} disabled={!item.override} icon={<MinusSquareOutlined />}>\n            重置本地覆盖\n          </Menu.Item>\n        </Menu>\n      }\n    >\n      <a className=\"ant-dropdown-link\" onClick={(e) => e.preventDefault()}>\n        操作 <DownOutlined />\n      </a>\n    </Dropdown>,\n  ];\n}\n\nconst ModuleEditDialog: React.FC<{ visible?; onVisibleChange?; module?; onModuleChange? }> = ({\n  visible,\n  onVisibleChange,\n  module,\n  onModuleChange,\n}) => {\n  const [form] = Form.useForm();\n  const lastRef = useRef(module);\n  useEffect(() => {\n    if (module && lastRef.current !== module) {\n      lastRef.current = module;\n      form.setFieldsValue(module);\n    }\n  }, [module]);\n  return (\n    <Modal title={'模块'} onOk={() => form.submit()} visible={visible} onCancel={() => onVisibleChange(false)}>\n      <Form\n        form={form}\n        labelCol={{ span: 4 }}\n        wrapperCol={{ span: 20 }}\n        initialValues={module || {}}\n        onFinish={(v) => {\n          if (onModuleChange(v) !== false) {\n            onVisibleChange(false);\n          }\n        }}\n      >\n        <Form.Item name={'name'} label={'模块名'} required rules={[{ required: true }]}>\n          <Input />\n        </Form.Item>\n        <Form.Item name={'resolved'} label={'地址'} required rules={[{ required: true }]}>\n          <Input />\n        </Form.Item>\n      </Form>\n    </Modal>\n  );\n};\nconst ModuleToolBar: React.FC<{ onRefresh?; onAddLocalModule?; onResetLocalModule? }> = ({\n  onRefresh,\n  onResetLocalModule,\n  onAddLocalModule,\n}) => {\n  const [state, update] = useImmer({ editing: false });\n  return (\n    <div>\n      <ModuleEditDialog\n        visible={state.editing}\n        onVisibleChange={(v) =>\n          update((s) => {\n            s.editing = v;\n          })\n        }\n        onModuleChange={onAddLocalModule}\n      />\n      <div style={{ display: 'flex', gap: 8 }}>\n        <Button.Group>\n          <Button\n            type={'primary'}\n            icon={<PlusSquareOutlined />}\n            onClick={() =>\n              update((s) => {\n                s.editing = true;\n              })\n            }\n          >\n            本地\n          </Button>\n          <Button onClick={onResetLocalModule} icon={<ClearOutlined />}>\n            重置\n          </Button>\n        </Button.Group>\n        <Button onClick={onRefresh} icon={<ReloadOutlined />}>\n          刷新\n        </Button>\n      </div>\n    </div>\n  );\n};\n"],"names":["ModuleManagementService","_boot","getBootService","_modules","this","modules","System","name","resolved","overrides","persistImportOverrides","Object","assign","loadImportOverrides","getModules","all","concat","entries","imports","map","predefined","byName","keyBy","v","ModuleMetas","m","tryResolve","override","values","byResolved","url","mod","info","resolveName","loaded","isInternal","metadata","forEach","internal","hasMetadata","Boolean","keys","length","source","startsWith","location","origin","test","version","jsdelivr","substr","match","getVersionFromResolvedUrl","dependencies","Array","from","dependents","flatMap","reduce","a","b","push","o","key","fromEntries","die","error","args","e","errors","msg","apply","Error","join","data","path","op","plugin","useImmer","initialValue","useState","i","useCallback","updater","updateValue","produce","ModuleList","loading","renderActions","React","List","itemLayout","dataSource","renderItem","item","Item","actions","Skeleton","avatar","title","active","Meta","_item$metadata2","style","paddingLeft","Tag","color","description","_item$metadata3","maxWidth","_svc","svc","updateModules","sort","localeCompare","doRefresh","s","doAddLocalModule","async","addOverrideModule","module","doModuleLoad","find","import","depName","dep","includes","notification","message","String","doModuleUnload","delete","has","edit","updateEdit","editing","undefined","ModuleEditDialog","visible","onModuleChange","onVisibleChange","ModuleToolBar","onRefresh","onResetLocalModule","resetOverrideModules","onAddLocalModule","onModuleLoad","onModuleUnload","renderModuleActions","onModuleReset","removeOverrideModule","onModuleEdit","onModulePublish","warn","opts","Button","onClick","type","size","disabled","Dropdown","overlay","Menu","icon","UploadOutlined","EditOutlined","MinusSquareOutlined","className","preventDefault","DownOutlined","form","Form","useForm","lastRef","useRef","useEffect","current","setFieldsValue","Modal","onOk","submit","onCancel","labelCol","span","wrapperCol","initialValues","onFinish","label","required","rules","Input","state","update","display","gap","Group","PlusSquareOutlined","ClearOutlined","ReloadOutlined"],"mappings":"w/EAuDO,MAAMA,qBACHC,MAAQC,SACRC,SAA0BC,KAAKH,MAAMI,aACrCC,OAASF,KAAKH,MAAMK,gCAEJC,KAAEA,EAAFC,SAAQA,SACzBL,SAASM,UAAUF,GAAQC,QAC1BJ,KAAKM,qDAEcH,KAAEA,WACpBH,KAAKD,SAASM,UAAUF,SACzBH,KAAKM,2DAGNP,SAASM,UAAY,SACpBL,KAAKM,qDAIXC,OAAOC,OAAOR,KAAKD,SAASM,gBAAiBI,iDAIhCH,EAAuBN,KAAKD,SAASM,WAGpDK,mBACQR,OAAEA,EAAFH,SAAUA,GAAaC,SAEzBW,EAAoB,GACxBA,EAAMA,EAAIC,OACRL,OAAOM,QAAQd,EAASe,SAASC,IAAI,EAAEZ,EAAMC,OAC3CD,KAAAA,EACAC,SAAAA,EACAY,YAAY,aAKRC,EAASC,EAAMP,EAAK,YACrB,MAAMQ,KAAKC,EAAa,OACrBC,EAAKJ,EAAOE,EAAEhB,MAAQc,EAAOE,EAAEhB,OAAS,CAAEA,KAAMgB,EAAEhB,KAAMC,SAAUL,EAASuB,WAAWH,EAAEhB,OAC9FI,OAAOC,OAAOa,EAAGF,OAGd,MAAOhB,EAAMC,KAAaG,OAAOM,QAAQd,EAASM,WACrDY,EAAOd,GAAQI,OAAOC,OAAOS,EAAOd,IAAS,GAAI,CAAEA,KAAAA,EAAMC,SAAAA,EAAUmB,UAAU,IAE/EZ,EAAMJ,OAAOiB,OAAOP,SAGhBQ,EAAaP,EAAMP,EAAK,gBAEzB,MAAOe,EAAKC,KAAQzB,EAAOW,UAAW,KAEpCc,iBAGCC,EAAQH,EAAWC,GAAOD,EAAWC,IAAQ,CAAEvB,KAAMJ,EAAS8B,YAAYH,IAAQA,EAAKtB,SAAUsB,GACvGE,EAAKE,QAAS,EAGV/B,EAASgC,WAAWH,EAAKzB,QAC3ByB,EAAKI,SAAWL,EAAIK,UAAY,IAIpCrB,EAAMJ,OAAOiB,OAAOC,GACpBd,EAAIsB,QAASd,IAvFV,IAAkCO,EAwFnCP,EAAEe,SAAWnC,EAASgC,WAAWZ,EAAEhB,MACnCgB,EAAEgB,YAAcC,QAAQ7B,OAAO8B,KAAKlB,EAAEa,UAAY,IAAIM,QACtDnB,EAAEoB,QA1FiCb,EA0FCP,EAAEf,UAxFlCoC,WADS,iCAER,WAGLd,EAAIc,WADM,sBAEL,QAELd,EAAIc,WAAWC,SAASC,QACnB,OAGL,kDAAkDC,KAAKjB,GAClD,YAEF,UA2EHP,EAAEyB,QAvGD,SAAmClB,SAClCmB,EAAW,mCACbnB,EAAIc,WAAWK,GAAW,OACtBxB,EAAIK,EAAIoB,OAAOD,EAASP,QAAQS,MAAM,kCACxC1B,SACKA,EAAE,SAIN,SA8FS2B,CAA0B7B,EAAEf,UACxCe,EAAE8B,aAAeC,MAAMC,KAAKpD,EAASkD,aAAa9B,EAAEhB,OAAS,YAGzDiD,EAAa,UACnBzC,EACG0C,QAAQ,EAAGlD,KAAAA,EAAM8C,aAAAA,KAAmBA,EAAalC,IAAKI,GAAM,CAACA,EAAGhB,KAChEmD,OAAO,CAACnC,GAAIoC,EAAGC,OACbrC,EAAEoC,GAAKpC,EAAEoC,IAAM,IAAIE,KAAKD,GAClBrC,GACNiC,GACLzC,EAAIsB,QAASd,IACXA,EAAEiC,WAAaA,EAAWjC,EAAEhB,OAAS,KAEhCQ,GAIX,SAASO,EAAMwC,EAAUC,UAChBpD,OAAOqD,YAAYF,EAAE3C,IAAKI,GAAM,CAACA,EAAEwC,GAAMxC,cC7GlC0C,EAAIC,OAAAA,IAAAA,EAAAA,UAAAA,OAA+BC,EAAAA,MAAAA,EAAAA,EAAAA,EAAAA,EAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAAA,UAAAA,MAAAA,eAAAA,QAAAA,IAAAA,SACrC,KACNC,EAAIC,GAAOH,GACXI,EAAOF,EAEG,mBAANA,EACPA,EAAEG,MAAM,KAAMJ,GACdC,EAHA,qBAAuBF,QAIhBM,MAAAA,WAAiBF,SAElBE,MAAAA,8BACqBN,GAC7BC,EAAKzB,OAAS,IAAMyB,EAAKM,KAAK,KAAO,IAAA,oDAAA,miHAjDlCJ,GAAS,GACX,kBACA,iDACA,0DAAA,SACDK,SAEA,uHACAA,KAGC,sHACA,sCACA,iEACA,oEACA,6FACA,+EACC,0CACA,8DACA,8DACA,gDACA,yEAAA,SACDC,SACK,6CAA+CA,MAEnD,yCAAA,SACDC,SACK,gCAAkCA,MAAAA,SAEvCC,SAAAA,mBACwBA,EAAAA,kFAAyFA,EAAAA,8CAAAA,SAEjHA,SACK,sBAAwBA,MAE5B,qgHCpBWC,GAASC,OAAAA,EACIC,EAASD,GAAAA,EAAAA,EAAAA,SAC7B,CAAAE,EAAA,GAELC,GAAAA,SAAYC,GACVC,EAAYC,GAAQF,MACnB,KChBA,MAAMG,GAMR,EAAGC,QAAAA,EAASlF,QAAAA,EAASmF,cAAAA,EAAiBjE,CAAAA,GAAM,OAE7CkE,2BACEA,gBAACC,GACCH,QAASA,EACTI,WAAW,aACXC,WAAYvF,EACZwF,WAAaC,qBACXL,gBAACC,EAAKK,MAAKC,QAAS,IAAIR,EAAcM,KACpCL,gBAACQ,GAASC,UAAOC,OAAO,EAAOZ,QAASO,EAAKP,QAASa,WACpDX,gBAACC,EAAKK,KAAKM,MACTF,MACEV,2BACEA,4BAAOK,EAAKvF,iBAAQuF,EAAK1D,+BAAU+D,OAAS,iBAAKL,EAAK1D,6BAALkE,EAAeH,OAAU,KAC1EV,wBAAMc,MAAO,CAAEC,YAAa,KACzBV,EAAK5D,QAAUuD,gBAACgB,GAAIC,MAAM,kBAC1BZ,EAAK1E,YAAcqE,gBAACgB,GAAIC,MAAM,gBAC9BZ,EAAKxD,UAAYmD,gBAACgB,GAAIC,MAAM,gBAC5BZ,EAAKvD,aAAekD,gBAACgB,GAAIC,MAAM,gBAC/BZ,EAAKnE,UAAY8D,gBAACgB,GAAIC,MAAM,oBAInCC,sBAAab,EAAK1D,6BAALwE,EAAeD,cAE9BlB,2BACEA,2BACEA,6BAAQK,EAAKtF,UACbiF,wBAAMc,MAAO,CAAEC,YAAa,IAC1Bf,gBAACgB,OAAKX,EAAK9C,SACXyC,gBAACgB,OAAKX,EAAKnD,UAGf8C,uBAAKc,MAAO,CAAEM,SAAU,SACrBrE,QAAQsD,EAAKzC,aAAaX,SACzB+C,2BACEA,oCAAYK,EAAKzC,aAAaoB,KAAK,OAGtCjC,QAAQsD,EAAKtC,WAAWd,SACvB+C,2BACEA,qCAAaK,EAAKtC,WAAWiB,KAAK,eC1CxD,IAAIqC,6BAM2C,WACvCC,EAJED,GAAOA,IAAQ,IAAI9G,EAKrBM,EAASJ,IAAiBI,QAEzBD,EAAS2G,GAAiBlC,GAAuB,IACtDiC,EAAIjG,aAAamG,KAAK,CAACtD,EAAGC,IAAMD,EAAEpD,KAAK2G,cAActD,EAAErD,QAEnD4G,EAAY,KAChBH,EAAeI,GAAML,EAAIjG,aAAamG,KAAK,CAACtD,EAAGC,IAAMD,EAAEpD,KAAK2G,cAActD,EAAErD,SAExE8G,EAAmBC,MAAAA,UACjBP,EAAIQ,kBAAkBC,GAC5BL,KAOIM,EAAeH,MAAAA,IACnBN,EAAe3G,IACbA,EAAQqH,KAAMnG,GAAMA,EAAEhB,OAASA,GAAMgF,SAAU,cAGzCjF,EAAOqH,OAAOpH,GACpByG,EAAe3G,UACPoB,EAAIpB,EAAQqH,KAAMnG,GAAMA,EAAEhB,OAASA,GACzCkB,EAAE8D,SAAU,EACZ9D,EAAES,QAAS,EAEXT,EAAE4B,aAAeC,MAAMC,KAAKrD,IAAiBG,QAAQgD,aAAa9C,IAAS,QAEtE,MAAMqH,KAAWnG,EAAE4B,aAAc,OAC9BwE,EAAMxH,EAAQqH,KAAMnG,GAAMA,EAAEhB,OAASqH,GACvCC,IAAQA,EAAIrE,WAAWsE,SAASvH,KAClCsH,EAAIrE,WAAa,IAAIqE,EAAIrE,WAAYjD,OAI3C,MAAO6D,GACP2D,EAAa7D,MAAM,CAAE8D,QAASC,OAAO7D,KAErC4C,EAAe3G,UACPoB,EAAIpB,EAAQqH,KAAMnG,GAAMA,EAAEhB,OAASA,GACzCkB,EAAE8D,SAAU,EACZ9D,EAAES,QAAS,MAKXgG,EAAkB3H,IACtByG,EAAe3G,UACPoB,EAAIpB,EAAQqH,KAAMnG,GAAMA,EAAEhB,OAASA,GACzCD,EAAO6H,OAAO1G,EAAEjB,UAEhBiB,EAAE8D,SAAU,EACZ9D,EAAES,OAAS5B,EAAO8H,IAAI3G,EAAEjB,cAGrB6H,EAAMC,GAAcxD,GAAS,CAAEyD,SAAS,EAAOf,YAAQgB,WAe5D/C,2BACEA,gBAACgD,IACCC,QAASL,EAAKE,QACdf,OAAQa,EAAKb,OACbmB,eAAgBrB,MAAAA,GAAaD,EAAiB9F,GAC9CqH,gBAAkBrH,GAChB+G,EAAYlB,IACVA,EAAEmB,QAAUhH,MAIlBkE,2BACEA,gBAACoD,IACCC,UAAW3B,EACX4B,mBA1EmBzB,gBACnBP,EAAIiC,uBACV7B,KAyEM8B,iBAAkB5B,KAGtB5B,gBAACH,IACCjF,QAASA,EACT6I,aAAczB,EACd0B,eAAgBjB,EAChB1C,cAAe4D,GAAoB,CACjCD,eAAgBjB,EAChBgB,aAAczB,EACd4B,cA9Bc/B,MAAAA,UACdP,EAAIuC,qBAAqB9B,GAC/BL,KA6BMoC,aAxCc/B,IACpBc,EAAYlB,IACVA,EAAEmB,SAAU,EACZnB,EAAEI,OAASA,KAsCPgC,gBAnCiBhC,IACvBQ,EAAQyB,KAAK,gBAyCjB,SAASL,GAAoBM,SAOrBR,aAAEA,EAAFC,eAAgBA,EAAhBI,aAAgCA,EAAhCC,gBAA8CA,EAA9CH,cAA+DA,GAAkBK,SAC/E5D,GAAqB,CAC3BL,gBAACkE,GAAOC,QAAS,IAAMV,EAAapD,EAAKvF,MAAOsJ,KAAK,OAAO9F,IAAI,OAAO+F,KAAK,QAAQC,SAAUjE,EAAK5D,cAGnGuD,gBAACkE,GAAOC,QAAS,IAAMT,EAAerD,EAAKvF,MAAOsJ,KAAK,OAAO9F,IAAI,SAAS+F,KAAK,QAAQC,UAAWjE,EAAK5D,cAGxGuD,gBAACuE,GACCjG,IAAK,OACLkG,QACExE,gBAACyE,OACCzE,gBAACyE,EAAKnE,MAAK6D,QAAS,IAAMJ,EAAgB1D,GAAOqE,KAAM1E,gBAAC2E,eAGxD3E,gBAACyE,EAAKnE,MAAK6D,QAAS,IAAML,EAAazD,GAAOqE,KAAM1E,gBAAC4E,eAGrD5E,gBAACyE,EAAKnE,MAAK6D,QAAS,IAAMP,EAAcvD,GAAOiE,UAAWjE,EAAKnE,SAAUwI,KAAM1E,gBAAC6E,qBAMpF7E,qBAAG8E,UAAU,oBAAoBX,QAAUxF,GAAMA,EAAEoG,wBAC9C/E,gBAACgF,WAMZ,MAAMhC,GAAuF,EAC3FC,QAAAA,EACAE,gBAAAA,EACApB,OAAAA,EACAmB,eAAAA,YAEO+B,GAAQC,EAAKC,UACdC,EAAUC,EAAOtD,UACvBuD,EAAU,KACJvD,GAAUqD,EAAQG,UAAYxD,IAChCqD,EAAQG,QAAUxD,EAClBkD,EAAKO,eAAezD,KAErB,CAACA,IAEF/B,gBAACyF,GAAM/E,MAAO,KAAMgF,KAAM,IAAMT,EAAKU,SAAU1C,QAASA,EAAS2C,SAAU,IAAMzC,GAAgB,IAC/FnD,gBAACkF,GACCD,KAAMA,EACNY,SAAU,CAAEC,KAAM,GAClBC,WAAY,CAAED,KAAM,IACpBE,cAAejE,GAAU,GACzBkE,SAAWnK,KACiB,IAAtBoH,EAAepH,IACjBqH,GAAgB,KAIpBnD,gBAACkF,EAAK5E,MAAKxF,KAAM,OAAQoL,MAAO,MAAOC,YAASC,MAAO,CAAC,CAAED,UAAU,KAClEnG,gBAACqG,SAEHrG,gBAACkF,EAAK5E,MAAKxF,KAAM,WAAYoL,MAAO,KAAMC,YAASC,MAAO,CAAC,CAAED,UAAU,KACrEnG,gBAACqG,YAMLjD,GAAkF,EACtFC,UAAAA,EACAC,mBAAAA,EACAE,iBAAAA,YAEO8C,EAAOC,GAAUlH,GAAS,CAAEyD,SAAS,WAE1C9C,2BACEA,gBAACgD,IACCC,QAASqD,EAAMxD,QACfK,gBAAkBrH,GAChByK,EAAQ5E,IACNA,EAAEmB,QAAUhH,IAGhBoH,eAAgBM,IAElBxD,uBAAKc,MAAO,CAAE0F,QAAS,OAAQC,IAAK,IAClCzG,gBAACkE,EAAOwC,WACN1G,gBAACkE,GACCE,KAAM,UACNM,KAAM1E,gBAAC2G,QACPxC,QAAS,IACPoC,EAAQ5E,IACNA,EAAEmB,SAAU,WAMlB9C,gBAACkE,GAAOC,QAASb,EAAoBoB,KAAM1E,gBAAC4G,gBAI9C5G,gBAACkE,GAAOC,QAASd,EAAWqB,KAAM1E,gBAAC6G"}